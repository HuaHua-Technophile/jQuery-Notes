<!DOCTYPE html>
<html lang="zh-CN" data-bs-theme="dark">
  <head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link
      rel="icon"
      href="https://i.328888.xyz/2023/04/14/ixDL13.jpeg"
      type="image/png" />
    <script src="https://cdn.bootcdn.net/ajax/libs/jquery/3.6.4/jquery.min.js"></script>
    <link
      href="https://cdn.bootcdn.net/ajax/libs/twitter-bootstrap/5.3.0-alpha3/css/bootstrap.css"
      rel="stylesheet" />
    <script src="https://cdn.bootcdn.net/ajax/libs/twitter-bootstrap/5.3.0-alpha3/js/bootstrap.bundle.js"></script>
    <title>花花</title>
  </head>

  <body>
    <button>获取数据</button>
    <script>
      // XMLHttpRequest.readyState 只读属性 返回 一个无符号短整型（unsigned short）数字，代表请求的状态码。 我们一般称之为Ajax状态码
      // 值	状态	描述
      // 0	UNSENT	代理被创建，但尚未调用 open() 方法。
      // 1	OPENED	open() 方法已经被调用。
      // 2	HEADERS_RECEIVED	send() 方法已经被调用，并且头部和状态已经可获得。
      // 3	LOADING	下载中；responseText 属性已经包含部分数据。
      // 4	DONE	下载操作已完成。

      // XMLHttpRequest.onreadystatechange 当 readyState 属性发生变化时，调用的事件处理器。
      // XMLHttpRequest.onreadystatechange 会在 XMLHttpRequest 的readyState 属性发生改变时触发 readystatechange 事件的时候被调用。

      // XMLHttpRequest.status 只读 返回一个无符号短整型（unsigned short）数字，代表请求的响应状态。
      //  XMLHttpRequest.status 只读属性 XMLHttpRequest.status 返回了 XMLHttpRequest 响应中的数字状态码。status 的值是一个无符号短整型。"在请求完成前，status 的值为 0"。值得注意的是，"如果 XMLHttpRequest 出错，浏览器返回的 status 也为 0"。status 码是标准的 HTTP status codes。举个例子，status 200 代表一个成功的请求。如果服务器响应中没有明确指定 status 码，XMLHttpRequest.status 将会默认为 200。

      // HTTP响应状态码
      // https://developer.mozilla.org/zh-CN/docs/Web/HTTP/Status
      // 响应被归为以下五大类：
      // 信息响应 (100–199)
      // 成功响应 (200–299)
      // 重定向消息 (300–399)
      // 客户端错误响应 (400–499)
      // 服务端错误响应 (500–599)

      // 下面是常见的 HTTP 状态码：
      // 200 - 请求成功
      // 301 - 资源（网页等）被永久转移到其它URL
      // 404 - 请求的资源（网页等）不存在
      // 500 - 内部服务器错误

      var btn = document.querySelector("button");
      btn.onclick = function () {
        // 1. 创建ajax对象
        var xhr = new XMLHttpRequest();

        // 2. 初始化ajax请求
        xhr.open("GET", "https://api.uomg.com/api/rand.qinghua");

        // 3. 发送请求
        xhr.send();

        // 4. 监听ajax状态码变化以及处理响应数据
        xhr.onreadystatechange = function () {
          // 当ajax状态码为4  并且 http状态为200
          if (xhr.readyState === 4 && xhr.status === 200) {
            // console.log( xhr.responseText );
            var data = JSON.parse(xhr.responseText);
            console.log(data);
            console.log(data.content);
          }
        };
      };
    </script>
  </body>
</html>
