<!DOCTYPE html>
<html lang="zh-CN" data-bs-theme="dark">
  <head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link
      rel="icon"
      href="https://i.328888.xyz/2023/04/14/ixDL13.jpeg"
      type="image/png" />
    <script src="https://cdn.bootcdn.net/ajax/libs/jquery/3.6.4/jquery.min.js"></script>
    <link
      href="https://cdn.bootcdn.net/ajax/libs/twitter-bootstrap/5.3.0-alpha3/css/bootstrap.css"
      rel="stylesheet" />
    <script src="https://cdn.bootcdn.net/ajax/libs/twitter-bootstrap/5.3.0-alpha3/js/bootstrap.bundle.js"></script>
    <title>花花</title>
  </head>

  <body>
    <button>获取数据</button>
    <script>
      // XMLHttpRequest.readyState 只读属性 返回 一个无符号短整型（unsigned short）数字，代表请求的状态码。 我们一般称之为Ajax状态码
      // 值	状态	描述
      // 0	UNSENT	代理被创建，但尚未调用 open() 方法。
      // 1	OPENED	open() 方法已经被调用。
      // 2	HEADERS_RECEIVED	send() 方法已经被调用，并且头部和状态已经可获得。
      // 3	LOADING	下载中；responseText 属性已经包含部分数据。
      // 4	DONE	下载操作已完成。

      // XMLHttpRequest.onreadystatechange 当 readyState 属性发生变化时，调用的事件处理器。
      // XMLHttpRequest.onreadystatechange 会在 XMLHttpRequest 的readyState 属性发生改变时触发 readystatechange 事件的时候被调用。

      let btn = document.querySelector("button");
      btn.onclick = function () {
        // 1. 创建ajax对象
        let xhr = new XMLHttpRequest();
        console.log("1. xhr.readyState=>", xhr.readyState);
        console.log("1. xhr.responseText=>", xhr.responseText);
        console.log("");
        // 2. 初始化ajax请求
        xhr.open("GET", "https://api.uomg.com/api/rand.qinghua");
        console.log("2. xhr.readyState=>", xhr.readyState);
        console.log("2. xhr.responseText=>", xhr.responseText);
        console.log("");
        // 3. 发送请求
        xhr.send();
        // 4. 监听ajax状态码变化以及处理响应数据
        xhr.onreadystatechange = function () {
          console.log(
            "readystatechange事件里面的xhr.readyState=>",
            xhr.readyState
          );
          console.log(
            "readystatechange事件里面的xhr.responseText=>",
            xhr.responseText
          );
          console.log("");
        };
      };
    </script>
  </body>
</html>
